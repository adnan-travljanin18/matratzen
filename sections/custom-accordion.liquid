<link href="{{ 'custom-accordion.css' | asset_url }}" rel="stylesheet" type="text/css">
<section data-section-id="{{ section.id }}" class="section-accordion" id="{{ section.settings.heading | handleize }}">
    <div class="container accordion-margins">
        <div class="row">
            <div class="col-sm-12 col-md-8 d-flex justify-content-md-normal justify-content-center">
                <div class="mb-4 mb-sm-7">
                    <h2 class="fw-medium lh-base letter-spacing mb-0">{{ section.settings.heading }}</h2>
                </div>
            </div>
            <div class="col-12">
                {% for block in section.blocks %}
                    {% assign accordions-title = block.settings['accordion-title'] %}
                    {% if accordions-title != blank and block.settings['accordion-text'] != blank %}
                        <div class="row px-3 px-md-3 accordion-button-hover ">
                            <a
                                href="#"
                                class="col-12 col-md-6 px-md-0 justify-content-between border-bottom py-4 border-gray-100 d-flex align-items-center justify-content-between arrow-positioning"
                                title="Open {{ accordions-title | strip_html }}"
                                rel="nofollow"
                                aria-label="Open {{ accordions-title | strip_html }}"
                                role="button"
                                aria-expanded="false"
                                onclick="toggleContent(event, {{ forloop.index }})"
                            >
                                <h5
                                    class="lh-base fw-normal letter-spacing mb-0"
                                    style="color:{{ section.settings.section_text_color }}"
                                >
                                    {{ accordions-title | strip_html }}
                                </h5>
                                <span class="icon-class icon-full-arrow-right d-block"></span>
                            </a>
                            <div
                                class="col-12 col-md-6 ps-0 ps-md-7"
                                id="content-text-{{ forloop.index }}"
                                data-type="content"
                                style="display: {% if forloop.first %} block {% else %} none {% endif %}; color:{{ section.settings.section_text_color }}"
                            >
                                <div class="fw-light letter-spacing p-3 p-md-0 pt-md-3">
                                    {{ block.settings['accordion-text'] }}
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
    <div class="container border-bottom border-gray-100 d-block"></div>
</section>

<script>
    // Function to set the initial active state
    function setInitialActiveState() {
        // Add 'active' class to the first anchor tag
        var firstAnchor = document.querySelector('.accordion-button-hover a');
        if (firstAnchor) {
            firstAnchor.classList.add('active');
        }
    }

    // Function to toggle content
    function toggleContent(event, index) {
        // Prevent the default anchor tag behavior (e.g., navigating to a new page)
        event.preventDefault();

        // Remove 'active' class from all anchor tags
        document.querySelectorAll('.accordion-button-hover a').forEach(function (element) {
            element.classList.remove('active');
        });

        // Add 'active' class to the clicked anchor tag
        event.currentTarget.classList.add('active');

        // Hide all content-text elements
        document.querySelectorAll('[data-type="content"]').forEach(function (element) {
            element.style.display = 'none';
        });

        // Show the selected content-text element
        var contentElement = document.getElementById('content-text-' + index);
        if (contentElement) {
            contentElement.style.display = 'block';
        }
    }

    // Set initial active state when the page loads
    document.addEventListener('DOMContentLoaded', setInitialActiveState);
</script>

<style>
    .arrow-positioning .icon-full-arrow-right {
        transition: transform 0.3s ease-in-out;
    }
    .arrow-positioning.active .icon-full-arrow-right {
        transform: rotate(45deg);
    }
</style>

{% schema %}
{
    "name": "Custom Accordion",
    "class": "dynamic-accordion-block",
    "settings": [
        {
            "type": "text",
            "id": "heading",
            "label": "Block Title",
            "default": "Harmony Oasis Details"
        },
        {
            "type": "color",
            "id": "section_text_color",
            "label": "Section Text Color",
            "default": "rgba(69, 90, 100, 1)"
        }
    ],
    "blocks": [
        {
            "type": "question",
            "name": "Accordion",
            "settings": [
                {
                    "type": "text",
                    "id": "accordion-title",
                    "label": "Accordion Title",
                    "default": "About Harmony A"
                },
                {
                    "type": "text",
                    "id": "accordion-text",
                    "label": "Accordion Text",
                    "default": "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Purus in massa tempor nec feugiat nisl. Ultrices gravida dictum fusce ut placerat. Orci eu lobortis elementum nibh tellus molestie nunc non. Nisl pretium fusce id velit. Suspendisse ultrices gravida dictum fusce ut placerat."
                }
            ]
        }
    ],
    "presets": [
        {
            "name": "Custom Accordion",
            "category": "Content"
        }
    ]
}
{% endschema %}
